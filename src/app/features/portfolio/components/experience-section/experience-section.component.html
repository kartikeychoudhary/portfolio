<section id="experience" class="experience-section">
  <div class="container">
    <!-- Section Header -->
    <h2 class="experience-title">
      Experience
    </h2>
    <p class="experience-subtitle">
      My professional journey
    </p>

    <!-- PrimeNG Timeline -->
    <div *ngIf="experiences$ | async as experiences" class="experience-content">
      <p-timeline
        [value]="experiences"
        layout="horizontal"
        align="top"
        styleClass="experience-timeline">

        <!-- Custom Marker Template -->
        <ng-template pTemplate="marker" let-experience>
          <div class="timeline-marker-wrapper">
            <div
              class="timeline-marker"
              [class.current]="experience.isCurrent">
              <img
                *ngIf="experience.companyLogo"
                [src]="experience.companyLogo"
                [alt]="experience.company"
                class="marker-logo">
              <i *ngIf="!experience.companyLogo" class="pi pi-briefcase marker-icon"></i>
            </div>
          </div>
        </ng-template>

        <!-- Custom Content Template -->
        <ng-template pTemplate="content" let-experience>
          <div class="experience-card" appSpotlightCard>
            <!-- Company & Role -->
            <div class="experience-header">
              <div class="experience-info">
                <div class="role-header">
                  <h3 class="experience-role">{{ experience.role }}</h3>
                  <span class="current-badge" *ngIf="experience.isCurrent">Current</span>
                </div>
                <p class="experience-company">{{ experience.company }}</p>
                <p class="experience-location" *ngIf="experience.location">
                  <i class="pi pi-map-marker"></i>
                  {{ experience.location }}
                </p>
              </div>
              <img
                *ngIf="experience.companyLogo"
                [src]="experience.companyLogo"
                [alt]="experience.company"
                class="experience-logo">
            </div>

            <!-- Duration -->
            <p class="experience-duration">
              {{ formatDate(experience.startDate) }} -
              {{ experience.isCurrent ? 'Present' : formatDate(experience.endDate!) }}
              Â· {{ calculateDuration(experience) }}
            </p>

            <!-- Description -->
            <div class="experience-description" [innerHTML]="experience.description"></div>

            <!-- Technologies -->
            <div class="experience-technologies" *ngIf="experience.technologies?.length">
              <span *ngFor="let tech of experience.technologies" class="experience-tech-tag">
                {{ tech }}
              </span>
            </div>
          </div>
        </ng-template>

        <!-- Date on Opposite Side -->
        <ng-template pTemplate="opposite" let-experience>
          <div class="timeline-date">
            {{ formatDate(experience.startDate) }}
          </div>
        </ng-template>
      </p-timeline>
    </div>
  </div>
</section>
